# üì¨ –ü–æ—á—Ç–∞–ª—å–æ–Ω ‚Äî –ò–Ω–¥–∏–≤–∏–¥—É–∞–ª—å–Ω–∞—è —Ä–∞–±–æ—Ç–∞ ‚Ññ2 (Python)

**–ê–≤—Ç–æ—Ä:** –®—É—Ä–º–∞–Ω–æ–≤ –î.–ê.  
**–ì—Ä—É–ø–ø–∞:** –ò–¢-9-2024  
**–ü—Ä–µ–¥–º–µ—Ç:** –Ø–∑—ã–∫ –ø—Ä–æ–≥—Ä–∞–º–º–∏—Ä–æ–≤–∞–Ω–∏—è Python  
**–í–∞—Ä–∏–∞–Ω—Ç:** 17  

---

## üß© –û–ø–∏—Å–∞–Ω–∏–µ –ø—Ä–æ–µ–∫—Ç–∞

–ü—Ä–æ–≥—Ä–∞–º–º–∞ —Ä–µ—à–∞–µ—Ç –∑–∞–¥–∞—á—É ¬´–ü–æ—á—Ç–∞–ª—å–æ–Ω¬ª:  
> –ú—É–¥—Ä—ã–π —Ç—Ä–∏—Ç–æ–Ω –¥–æ—Å—Ç–∞–≤–ª—è–µ—Ç –ø–∏—Å—å–º–∞ –ø—Ç–∏—Ü–∞–º, –∂–∏–≤—É—â–∏–º –≤ –≥–Ω—ë–∑–¥–∞—Ö –Ω–∞ –±–∏–Ω–∞—Ä–Ω–æ–º –¥–µ—Ä–µ–≤–µ.  
> –ï—Å–ª–∏ –æ–Ω –ø—Ä–æ—Ö–æ–¥–∏—Ç —á–µ—Ä–µ–∑ –≥–Ω–µ–∑–¥–æ, –Ω–æ –Ω–µ –æ—Å—Ç–∞–≤–ª—è–µ—Ç –ø–∏—Å—å–º–æ, –µ–º—É –ø—Ä–∏—Ö–æ–¥–∏—Ç—Å—è **–∏–∑–≤–∏–Ω—è—Ç—å—Å—è**.  
> –ù–µ–æ–±—Ö–æ–¥–∏–º–æ –æ–ø—Ä–µ–¥–µ–ª–∏—Ç—å **–º–∏–Ω–∏–º–∞–ª—å–Ω–æ–µ –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ –∏–∑–≤–∏–Ω–µ–Ω–∏–π**, –∫–æ—Ç–æ—Ä–æ–µ –ø—Ä–∏–¥—ë—Ç—Å—è –ø—Ä–∏–Ω–µ—Å—Ç–∏,  
> –∏—Å—Ö–æ–¥—è –∏–∑ —Å—Ç—Ä—É–∫—Ç—É—Ä—ã –¥–µ—Ä–µ–≤–∞ –∏ –∫–æ–ª–∏—á–µ—Å—Ç–≤–∞ –ø–∏—Å–µ–º –¥–ª—è –∫–∞–∂–¥–æ–≥–æ –≥–Ω–µ–∑–¥–∞.

---

## üìò –§–æ—Ä–º–∞—Ç –≤—Ö–æ–¥–Ω—ã—Ö –¥–∞–Ω–Ω—ã—Ö

–í—Ö–æ–¥–Ω—ã–µ –¥–∞–Ω–Ω—ã–µ —Ö—Ä–∞–Ω—è—Ç—Å—è –≤ —Ç–µ–∫—Å—Ç–æ–≤–æ–º —Ñ–∞–π–ª–µ `input.txt`.

**–ü—Ä–∏–º–µ—Ä —Å—Ç—Ä—É–∫—Ç—É—Ä—ã:**
```
5
3 2 2 5 4
1 1 1
1 1 4
2 2 3 1
1 3 1
```

- –ü–µ—Ä–≤–∞—è —Å—Ç—Ä–æ–∫–∞ ‚Äî —á–∏—Å–ª–æ `M` (–∫–æ–ª–∏—á–µ—Å—Ç–≤–æ –≥–Ω—ë–∑–¥, 0 < M < 1000)
- –î–ª—è –∫–∞–∂–¥–æ–≥–æ –≥–Ω–µ–∑–¥–∞:
  - `ni` ‚Äî –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ —Å–æ—Å–µ–¥–µ–π  
  - `li` ‚Äî –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ –ø–∏—Å–µ–º  
  - –¥–∞–ª–µ–µ `ni` —á–∏—Å–µ–ª ‚Äî –Ω–æ–º–µ—Ä–∞ —Å–æ—Å–µ–¥–Ω–∏—Ö –≥–Ω—ë–∑–¥

---

## üì§ –§–æ—Ä–º–∞—Ç –≤—ã—Ö–æ–¥–Ω—ã—Ö –¥–∞–Ω–Ω—ã—Ö

–ü—Ä–æ–≥—Ä–∞–º–º–∞ –∑–∞–ø–∏—Å—ã–≤–∞–µ—Ç –≤ `output.txt` –æ–¥–Ω–æ —á–∏—Å–ª–æ ‚Äî  
**–º–∏–Ω–∏–º–∞–ª—å–Ω–æ–µ –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ –∏–∑–≤–∏–Ω–µ–Ω–∏–π** —Ç—Ä–∏—Ç–æ–Ω–∞.

---

## ‚öôÔ∏è –ê–ª–≥–æ—Ä–∏—Ç–º —Ä–µ—à–µ–Ω–∏—è

1. **–ß—Ç–µ–Ω–∏–µ –¥–∞–Ω–Ω—ã—Ö –∏–∑ —Ñ–∞–π–ª–∞** (`read_input()`):
   - –ü—Ä–æ–≤–µ—Ä–∫–∞ –∫–æ—Ä—Ä–µ–∫—Ç–Ω–æ—Å—Ç–∏ –¥–∞–Ω–Ω—ã—Ö, –¥–∏–∞–ø–∞–∑–æ–Ω–æ–≤ –∏ —Ñ–æ—Ä–º–∞—Ç–∞.
2. **–ü–æ—Å—Ç—Ä–æ–µ–Ω–∏–µ –¥–µ—Ä–µ–≤–∞** (`build_tree()`):
   - –ò—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è –æ–±—Ö–æ–¥ –≤ —à–∏—Ä–∏–Ω—É (BFS) –¥–ª—è –æ–ø—Ä–µ–¥–µ–ª–µ–Ω–∏—è —Å–≤—è–∑–µ–π.
3. **–û–ø—Ä–µ–¥–µ–ª–µ–Ω–∏–µ —Ü–µ–ª–µ–≤—ã—Ö –≥–Ω—ë–∑–¥** (`__collect_target_nodes()`):
   - –ì–Ω—ë–∑–¥–∞, –≤ –∫–æ—Ç–æ—Ä—ã–µ –Ω—É–∂–Ω–æ –¥–æ—Å—Ç–∞–≤–∏—Ç—å –ø–∏—Å—å–º–∞.
4. **–§–æ—Ä–º–∏—Ä–æ–≤–∞–Ω–∏–µ –º–∏–Ω–∏–º–∞–ª—å–Ω–æ–≥–æ –ø–æ–¥–¥–µ—Ä–µ–≤–∞** (`__build_subtree()`):
   - –í–∫–ª—é—á–∞–µ—Ç –≤—Å–µ —Ü–µ–ª–µ–≤—ã–µ —É–∑–ª—ã –∏ –∏—Ö –ø—Ä–µ–¥–∫–æ–≤.
5. **–†–∞—Å—á—ë—Ç –∏–∑–≤–∏–Ω–µ–Ω–∏–π** (`_calculate_apologies()`):
   - –ù–∞ –æ—Å–Ω–æ–≤–µ –∫–æ–ª–∏—á–µ—Å—Ç–≤–∞ –ø–æ—Å–µ—â–µ–Ω–∏–π –∏ –≥–ª—É–±–∏–Ω—ã —É–∑–ª–æ–≤.
6. **–°–æ—Ö—Ä–∞–Ω–µ–Ω–∏–µ —Ä–µ–∑—É–ª—å—Ç–∞—Ç–∞** (`save_result()`).

---

## –û—Å–æ–±–µ–Ω–Ω–æ—Å—Ç–∏
- –ö–æ–¥ –Ω–∞–ø–∏—Å–∞–Ω —Å –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ–º –º–µ—Ç–æ–¥–æ–ª–æ–≥–∏–∏ –û–û–ü (–∫–ª–∞—Å—Å—ã –∏ —Ñ—É–Ω–∫—Ü–∏–∏).
- –í–∫–ª—é—á–µ–Ω–∞ –æ–±—Ä–∞–±–æ—Ç–∫–∞ –∏—Å–∫–ª—é—á–µ–Ω–∏–π (FileNotFoundError, ValueError) –¥–ª—è –Ω–µ–∫–æ—Ä—Ä–µ–∫—Ç–Ω–æ–≥–æ –≤–≤–æ–¥–∞.
- –î—Ä—É–∂–µ—Å—Ç–≤–µ–Ω–Ω—ã–π –∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å —Ä–µ–∞–ª–∏–∑–æ–≤–∞–Ω —á–µ—Ä–µ–∑ –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫—É—é –æ–±—Ä–∞–±–æ—Ç–∫—É —Ñ–∞–π–ª–æ–≤ –±–µ–∑ –∏–Ω—Ç–µ—Ä–∞–∫—Ç–∏–≤–Ω–æ–≥–æ –≤–≤–æ–¥–∞.

---

## üßÆ –ü—Ä–∏–º–µ—Ä —Ä–∞–±–æ—Ç—ã –ø—Ä–æ–≥—Ä–∞–º–º—ã

**input.txt**
```
5
3 2 2 5 4
1 1 1
1 1 4
2 2 3 1
1 3 1
```

**–ó–∞–ø—É—Å–∫ –ø—Ä–æ–≥—Ä–∞–º–º—ã:**
```
$ python pochta 2.py
```

**–í—ã–≤–æ–¥:**
```
==================================================
 –ü–†–û–ì–†–ê–ú–ú–ê –†–ê–°–ß–ï–¢–ê –ú–ê–†–®–†–£–¢–ê –ü–û–ß–¢–ê–õ–¨–û–ù–ê
==================================================

–†–ï–ó–£–õ–¨–¢–ê–¢: —Ç—Ä–∏—Ç–æ–Ω—É –ø—Ä–∏–¥–µ—Ç—Å—è –∏–∑–≤–∏–Ω–∏—Ç—å—Å—è 2 —Ä–∞–∑–∞
–†–µ–∑—É–ª—å—Ç–∞—Ç —Å–æ—Ö—Ä–∞–Ω–µ–Ω –≤ —Ñ–∞–π–ª output.txt
```

---

## üß† –û—Å–æ–±–µ–Ω–Ω–æ—Å—Ç–∏ –∏ –æ–±—Ä–∞–±–æ—Ç–∫–∞ –æ—à–∏–±–æ–∫

- –ü—Ä–æ–≤–µ—Ä—è–µ—Ç—Å—è –∫–æ—Ä—Ä–µ–∫—Ç–Ω–æ—Å—Ç—å —Å—Ç—Ä—É–∫—Ç—É—Ä—ã –¥–µ—Ä–µ–≤–∞.  
- –†–µ–∞–ª–∏–∑–æ–≤–∞–Ω—ã –ø—Ä–æ–≤–µ—Ä–∫–∏:
  - –ü—É—Å—Ç–æ–π —Ñ–∞–π–ª;
  - –ù–µ–∫–æ—Ä—Ä–µ–∫—Ç–Ω—ã–µ –Ω–æ–º–µ—Ä–∞ –≥–Ω—ë–∑–¥;
  - –ù–µ—Å–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤–∏–µ –∫–æ–ª–∏—á–µ—Å—Ç–≤–∞ —Å–æ—Å–µ–¥–µ–π;
  - –ù–µ–≤–µ—Ä–Ω–æ–µ –∑–Ω–∞—á–µ–Ω–∏–µ M;
  - –û—Ç—Ä–∏—Ü–∞—Ç–µ–ª—å–Ω—ã–µ –∑–Ω–∞—á–µ–Ω–∏—è.  
- –ü—Ä–∏ –æ—à–∏–±–∫–µ –ø—Ä–æ–≥—Ä–∞–º–º–∞ —Å–æ–æ–±—â–∞–µ—Ç –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—é, –≤ –∫–∞–∫–æ–º –º–µ—Å—Ç–µ –≤–æ–∑–Ω–∏–∫–ª–∞ –ø—Ä–æ–±–ª–µ–º–∞.

---

## üìÅ –°—Ç—Ä—É–∫—Ç—É—Ä–∞ –ø—Ä–æ–µ–∫—Ç–∞

```
üìÇ PostmanProject
 ‚î£ üìú po—Åhta 2.py          # –û—Å–Ω–æ–≤–Ω–æ–π –∫–æ–¥ –ø—Ä–æ–≥—Ä–∞–º–º—ã
 ‚î£ üìú input.txt           # –ü—Ä–∏–º–µ—Ä –≤—Ö–æ–¥–Ω—ã—Ö –¥–∞–Ω–Ω—ã—Ö
 ‚î£ üìú output.txt          # –§–∞–π–ª –¥–ª—è —Ä–µ–∑—É–ª—å—Ç–∞—Ç–∞
 ‚îó üìò README.md           # –û–ø–∏—Å–∞–Ω–∏–µ –ø—Ä–æ–µ–∫—Ç–∞
```

---

## üß© –ö–∞–∫ –∏–∑–º–µ–Ω–∏—Ç—å —Ä–µ–∑—É–ª—å—Ç–∞—Ç

–ß—Ç–æ–±—ã –∏–∑–º–µ–Ω–∏—Ç—å –∏—Ç–æ–≥–æ–≤–æ–µ –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ ¬´–∏–∑–≤–∏–Ω–µ–Ω–∏–π¬ª,  
–¥–æ—Å—Ç–∞—Ç–æ—á–Ω–æ **–∏–∑–º–µ–Ω–∏—Ç—å —Å—Ç—Ä—É–∫—Ç—É—Ä—É –¥–µ—Ä–µ–≤–∞ –∏–ª–∏ –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ –ø–∏—Å–µ–º** –≤ `input.txt`:

- –£–≤–µ–ª–∏—á–∏—Ç—å —á–∏—Å–ª–æ –ø–∏—Å–µ–º (`li > 0`) ‚Äî —É–º–µ–Ω—å—à–∏—Ç –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ –∏–∑–≤–∏–Ω–µ–Ω–∏–π.
- –î–æ–±–∞–≤–∏—Ç—å –±–æ–ª—å—à–µ —É–∑–ª–æ–≤ –±–µ–∑ –ø–∏—Å–µ–º ‚Äî —É–≤–µ–ª–∏—á–∏—Ç –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ –∏–∑–≤–∏–Ω–µ–Ω–∏–π.

---

## üí° –ü—Ä–∏–º–µ—Ä —Ç–µ—Å—Ç–æ–≤

| –í—Ö–æ–¥–Ω—ã–µ –¥–∞–Ω–Ω—ã–µ | –†–µ–∑—É–ª—å—Ç–∞—Ç |
|----------------|------------|
| 3 —É–∑–ª–∞, –ø–∏—Å—å–º–∞ —Ç–æ–ª—å–∫–æ –≤ –∫–æ—Ä–Ω–µ | 0 |
| 4 —É–∑–ª–∞, –ø–∏—Å—å–º–∞ –≤ –ª–∏—Å—Ç—å—è—Ö | 3 |
| 6 —É–∑–ª–æ–≤, –ø–∏—Å—å–º–∞ –≤ —Å–µ—Ä–µ–¥–∏–Ω–µ –¥–µ—Ä–µ–≤–∞ | 5 |

---

## üßë‚Äçüíª –ò—Å–ø–æ–ª—å–∑—É–µ–º—ã–µ —Ç–µ—Ö–Ω–æ–ª–æ–≥–∏–∏

- Python 3.11+
- BFS-–æ–±—Ö–æ–¥ –¥–µ—Ä–µ–≤–∞
- –ö–ª–∞—Å—Å–æ–≤–∞—è –æ—Ä–≥–∞–Ω–∏–∑–∞—Ü–∏—è –∫–æ–¥–∞ (–û–û–ü)

---

## üñº –í–∏–∑—É–∞–ª–∏–∑–∞—Ü–∏—è –¥–µ—Ä–µ–≤–∞

–ü—Ä–∏–º–µ—Ä —Å—Ç—Ä—É–∫—Ç—É—Ä—ã –¥–µ—Ä–µ–≤–∞:
```
       (1)
      /   \
    (2)   (3)
   /  \     \
 (4)  (5)   (6)
```

---
